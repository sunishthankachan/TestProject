<%@ page import="com.westpac.nzlo.common.NZLOFeatures" %>
<!-- Tag Lib Integration -->
<%@ taglib uri="/WEB-INF/struts-bean.tld" prefix="bean"%>
<%@ taglib uri="/WEB-INF/struts-html.tld" prefix="html"%>
<%@ taglib uri="/WEB-INF/struts-logic.tld" prefix="logic"%>
<%@ taglib uri="/WEB-INF/struts-tiles.tld" prefix="tiles"%>
<%@ taglib uri="/WEB-INF/c.tld" prefix="c"%>
<head>
</head>

<script>
    function CheckForAttachments(sortColumn, tableId) {
        if(document.getElementById(tableId)!=null)
        {
            sortTable(sortColumn,'documentAttach','documentAttach0');
        }
    }
</script>

<script type="text/javascript" src="js/lendingapplication/Attachment.js"></script>
<script type="text/javascript"  src="js/common/MenuSubmit.js"></script>
<script type="text/javascript"  src="js/common/sortTable.js"></script>
<!-- Script included for NP-13945 W1201 - by Aruna Starts -->
<script type="text/javascript"  src="js/common/partialSortTable.js"></script>
<!-- Script included for NP-13945 W1201 - by Aruna Ends -->
<!-- Script included for W0905 - Infoman 2784837 SIT Defect Starts -->
<script type="text/javascript" src="js/common/ConfirmationMessage.js"></script>
<!-- Script included for W0905 - Infoman 2784837 SIT Defect Ends -->
<link href="style/general/tableSortStyles.css" rel="stylesheet" type="text/css" />

<body onload="doOnLoad();CheckForAttachments(0,'documentAttach')">

<!-- Code changes done by Aruna for NP-13945 W1201--Starts -->
<html:form action="/addNewDocToLendingApplication" styleId="formId" readonly="${listLendingApplicationDocForm.readonly}"  enctype="multipart/form-data">

    <c:set var="fileName" value="fileName" />
    <c:set var="asc" value="asc" />
    <c:set var="desc" value="desc" />
    <c:set var="sortProperty" value="${listLendingApplicationDocForm.documentAtachmentVO.sortProperty}" />
    <c:set var="sortOrder" value="${listLendingApplicationDocForm.documentAtachmentVO.sortOrder}" />
    <c:set var="fileType" value="fileType" />
    <c:set var="dateAndTime" value="dateAndTime" />
    <c:set var="categoryDesc" value="categoryDesc" />
    <!-- Code changes done by Aruna for NP-13945 W1201 on 02-12-2011 --Starts -->
    <table>
        <tr>
            <td width="160" class="alignMiddle">
                Show files from category:
            </td>
            <td>
                <html:select name="listLendingApplicationDocForm" property="documentAtachmentVO.selectedFileCategory" tabindex="2" styleId="selectedAttachId" disabled="${listLendingApplicationDocForm.readonly}" onchange="filterAttachments();" >
                    <html:option value=""> Any </html:option>
                    <c:forEach items="${listLendingApplicationDocForm.documentAtachmentVO.fileCategoryList}" var="fileCategory" varStatus="fileCategoryStatus">
                        <html:option value="${fileCategory.code}" >
                            <c:out value="${fileCategory.description}" />
                        </html:option>
                    </c:forEach>
                </html:select>
            </td>
        </tr>
    </table>
    <!-- Code changes done by Aruna for NP-13945 W1201 on 02-12-2011 --Ends -->
    <!-- Code changes done by Aruna for NP-13945 W1201--Ends -->
    <c:choose>
        <c:when test="${not empty listLendingApplicationDocForm.documentAtachmentVO.fileVOList}">
            <table class="nzloStdTable width970" id="documentAttach" border="0">
                <tr>
                    <th width="160" class="sorted"><a href="javascript:sortTable(0,'documentAttach','documentAttach0');" title="Category" id="SortRelated1" tabindex="1">Category</a><img id="documentAttach0" src="images/sort_arrow_down.gif" name="noName" class="disappear" width="15" height="13" /></th>
                    <th width="160" class="hideRightNow"><a href="javascript:sortTable(1, 'documentAttach','documentAttach1');" title="File Name" tabindex="" id="SortRelated1">File Name</a><img id="documentAttach1" name="noName" src="images/sort_arrow_down.gif" class="disappear" width="15" height="13" /></th>
                    <th width="186" class="noSorting">File Type</th>
                    <th width="100" class="noSorting">Comments</th>
                    <th width="125" class="noSorting">Upload date and time</th>
                    <th width="30" class="noSorting">Uploaded By</th>
                    <th class="noString"></th>
                    <th class="noString"></th>
                </tr>

                <c:forEach items="${listLendingApplicationDocForm.documentAtachmentVO.fileVOList}" var="fileVO" varStatus="fileStatus">
                <tr class="${fileStatus.index%2 == 0 ? 'odd' : 'even'}">
                    <td width="175"><c:out value="${fileVO.categoryDesc}" /> </td>
                    <td width="175"><c:out value="${fileVO.fileName}" /></td>
                    <!-- Code changes done by Aruna for NP-13945 W1201--Ends -->
                    <c:if test="${fileVO.fileExtension == '.doc'}" ><td width="186"><img src="images/icon_WordDocument.bmp" /> <c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>
                    <c:if test="${fileVO.fileExtension == '.pdf'}" ><td width="186"><img src="images/icon_PDFDocument.bmp" /> <c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>
                    <c:if test="${fileVO.fileExtension == '.xls'}" ><td width="186"><img src="images/icon_ExcelDocument.bmp" /> <c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>
                    <c:if test="${fileVO.fileExtension == '.jpg'}" ><td width="186"><img src="images/icon_jpg.gif" /> <c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>
                    <c:if test="${fileVO.fileExtension == '.gif'}" ><td width="186"><img src="images/icon_gif.gif" /> <c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>
                    <c:if test="${fileVO.fileExtension == '.tif'}" ><td width="186"><img src="images/icon_tif.gif" /> <c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>
                    <c:if test="${fileVO.fileExtension == '.rtf'}" ><td width="186"><img src="images/icon_rtf.gif"/> <c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>
                    <c:if test="${fileVO.fileExtension == '.zip'}" ><td width="186"><img src="images/icon_zip.gif" /><c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>
                    <c:if test="${fileVO.fileExtension == '.txt'}" ><td width="186"><img src="images/icon_txtfile.bmp" />&nbsp;<c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>
                    <c:if test="${fileVO.fileExtension == '.docx'}"><td width="186"><img src="images/icon_docx.jpeg" />&nbsp;<c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>
                    <c:if test="${fileVO.fileExtension == '.xlsx'}"><td width="186"><img src="images/icon_xlsx.jpeg" />&nbsp;<c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>
                    <!-- MR1402 Tech refresh - moving to Office 2010 - Begins-->
                    <c:if test="${fileVO.fileExtension == '.docm'}"><td width="186"><img src="images/icon_docm.jpeg" />&nbsp;<c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>
                    <c:if test="${fileVO.fileExtension == '.xlsm'}"><td width="186"><img src="images/icon_xlsm.jpeg" />&nbsp;<c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>
                    <c:if test="${fileVO.fileExtension == '.html'}"><td width="186"><c:out value="${fileVO.fileType}" />(<c:out value="${fileVO.fileExtension}" />)</td></c:if>

                    <!-- MR1402 Tech refresh - moving to Office 2010 - Ends-->
                    <td width="100"><c:out value="${fileVO.description}" /> </td>
                    <td width="125"><c:out value="${fileVO.dateAndTime}" /> </td>
                    <td width="30"><c:out value="${fileVO.uploadedBy}" /> </td>
                    <td><a href="javascript:viewdoc('<c:out value="${fileVO.oid}"/>')" id="viewAttachment1" title="view this document">View</a></td>
                    <!-- NP16086 - Allow incorrect attachments to be removed from completed applications for a newly created AD role:Starts -->
                    <c:choose>
                        <c:when test="${(listLendingApplicationDocForm.disabled == false or listLendingApplicationDocForm.documentAtachmentVO.maintainAttachmentsRole == true) && fileVO.categoryCode ne 'ECR'}">
                            <td>
                                <a href="javascript:removedoc('<c:out value="${fileVO.oid}"/>')" id="removeAttachment1" title="remove attachment from Lending Application">Remove</a>
                            </td>
                        </c:when>
                        <c:otherwise>
                            <c:choose>
                                <c:when test="${listLendingApplicationDocForm.documentAtachmentVO.maintainAttachmentsRole eq true && fileVO.categoryCode eq 'ECR'}">
                                    <td>
                                        <a href="javascript:removedoc('<c:out value="${fileVO.oid}"/>')" id="removeAttachment1" title="remove attachment from Lending Application">Remove</a>
                                    </td>
                                </c:when>
                                <c:otherwise>
                                    <!-- Enquiry access: Never show remove button -->
                                    <td></td>
                                </c:otherwise>
                            </c:choose>
                        </c:otherwise>
                    </c:choose>
                    <!-- NP16086 - Allow incorrect attachments to be removed from completed applications for a newly created AD role:Ends -->
                </tr>
                </c:forEach>

            </table>
        </c:when>
        <c:otherwise>
            <table>
                <tr>
                    <td>No documents are currently attached to the lending application</td>
                </tr>
            </table>
        </c:otherwise>
    </c:choose>
    &nbsp;&nbsp;
    <table>
        <tr>
            <td>
                <a href="javascript:viewattach();" id="uploadattach1" title="upload a file">Upload a file</a>
            </td>
        </tr>
    </table>


    <div class="clearit height10"></div>

    <!--  <table class="width570">
    <tr>
    <td width="77" class="alignMiddle">Select a file:</td>
    <td width="481">-->
    <!--  Changes done by Bhaskar on 24/05/2011 for  WR 13617 in W1104 Starts -->
    <!--<html:file property="documentAtachmentVO.formFile"  title="Click Browse to select a file" styleId="docAttachFilePathId" />
    &nbsp;-->
    <!-- button name="Submit" < c:out value="${listLendingApplicationDocForm.disabledAsStyle}" /> onclick="addNewDoc()" tabindex="50" id="gotoAttachNewDocument" title="Attach a document to the Lending Application" accesskey="A"><span class="underline">A</span>ttach  new document</ button>< /td -->
    <!--  <button name="Submit" onclick="addNewDoc()" tabindex="50" id="gotoAttachNewDocument" title="Attach a document to the Lending Application" accesskey="A"><span class="underline">A</span>ttach  new document</button></td>-->
    <!--  Changes done by Bhaskar on 24/05/2011 for WR 13617 in W1104 Ends -->
    <!-- </tr>
    </table>-->

    <html:hidden name="listLendingApplicationDocForm" property="documentAtachmentVO.applicationNumber" styleId="applicationNumber" value="${listLendingApplicationDocForm.lendingApplicationNumber}"/>
    <input type="hidden" id="contextPath" name="contextPath" value="<c:out value="${RequestScope.requestedURI}${pageContext.request.contextPath}"/>" />
    <input type="hidden" id="initActionId" name="initAction"/>
    <html:hidden name="listLendingApplicationDocForm" property="lendingApplicationNumber" styleId="lendingApplicationNumber"/>
    <html:hidden name="listLendingApplicationDocForm" property="documentAtachmentVO.sortProperty" styleId="propertyId"  />
    <html:hidden name="listLendingApplicationDocForm" property="documentAtachmentVO.sortOrder" styleId="orderId"  />
    <html:hidden name="listLendingApplicationDocForm" property="documentAtachmentVO.fileViewIDHidden" styleId="fileViewIDHidden" value=""/>
    <html:hidden name="listLendingApplicationDocForm" property="fileSizeIDHidden" styleId="fileSizeIDHidden" value=""/>
    <!-- Hidden value included for W1104 NP-13617 by Gaurav on 25/25/2011 starts
    <html:hidden name="listLendingApplicationDocForm" property="documentAtachmentVO.removeIDHidden" styleId="removeIDHidden" value=""/>
    -->
    <html:hidden name="listLendingApplicationDocForm" property="documentAtachmentVO.oid" styleId="oid" value="${listLendingApplicationDocForm.documentAtachmentVO.oid}"/>

    <!-- Hidden value included for W1104 NP-13617 by Gaurav on 25/25/2011 ends -->
    <!-- Hidden Values included for W0905 - Infoman 2784837 SIT Defect Starts -->
    <html:hidden name="listLendingApplicationDocForm" property="documentAtachmentVO.proceedID" styleId="proceedId" value="${listLendingApplicationDocForm.documentAtachmentVO.proceedAction}" />
    <html:hidden name="listLendingApplicationDocForm" property="documentAtachmentVO.cancelID" styleId="cancelId"  value="${listLendingApplicationDocForm.documentAtachmentVO.cancelAction}" />
    <html:hidden name="listLendingApplicationDocForm" property="documentAtachmentVO.attachmentExistsFileID" styleId="attachmentExistsFileID" value="${listLendingApplicationDocForm.documentAtachmentVO.attachmentExistsFileID}"/>
    <html:hidden name="listLendingApplicationDocForm" property="documentAtachmentVO.attachmentExistsOID" styleId="attachmentExistsOID" value="${listLendingApplicationDocForm.documentAtachmentVO.attachmentExistsOID}"/>
    <!-- hidden value removed for W1104 NP-13617 by Gaurav on 25/25/2011 starts
    <html:hidden name="listLendingApplicationDocForm" property="documentAtachmentVO.oid" styleId="oid" value=""/>
    hidden value removed for W1104 NP-13617 by Gaurav on 25/25/2011 ends -->
    <html:hidden property="actionType" styleId="actionType" />
    <c:forEach items="${listLendingApplicationDocForm.documentAtachmentVO.fileCategoryList}" var="fileCategory" varStatus="fileCategoryStatus">
        <html:hidden property="documentAtachmentVO.fileCategoryList[${fileCategoryStatus.index}].code" styleId="code${fileCategoryStatus.index}"/>
        <html:hidden property="documentAtachmentVO.fileCategoryList[${fileCategoryStatus.index}].description" styleId="description${fileCategoryStatus.index}"/>
    </c:forEach>
    <!-- Hidden Values included for W0905 - Infoman 2784837 SIT Defect Ends -->
    <!-- NP16086 - Allow incorrect attachments to be removed from completed applications for a newly created AD role:Starts -->
    <html:hidden name="listLendingApplicationDocForm" property="documentAtachmentVO.maintainAttachmentsRole" styleId="maintainAttachmentsRoleId" value="${listLendingApplicationDocForm.documentAtachmentVO.maintainAttachmentsRole}"/>
    <!-- NP16086 - Allow incorrect attachments to be removed from completed applications for a newly created AD role:Endss -->
</html:form>
<!-- Code changes done by Aruna for NP-13945 W1201--Ends -->
</div>
<!-- The right pannel content of page ends -->
</div>
<!-- The nzlo wide container of page ends -->
</div>
<!-- The main content of page ends -->
</body>